#!/bin/sh

VERBOSE_INSTALL=yes

set -e

if [ -f /etc/debian_version ] ; then
	/usr/share/dtc/admin/install/uninstall
	. /usr/share/dtc/admin/install/debian_config
	. ${DTC_SAVED_INSTALL_CONFIG}
	if [ ""$conf_apache_version = "2" ] ; then
		PATH_HTTPD_CONF=/etc/apache2/apache2.conf
	else
		PATH_HTTPD_CONF=/etc/apache/httpd.conf
	fi
	. /usr/share/dtc/admin/install/functions
	DTCsetupDaemons
fi

if [ -f /etc/redhat-release ] ; then
	# Prepare everything
	. /usr/share/dtc/admin/install/redhat_config
	. /usr/share/dtc/admin/install/functions
	. /usr/share/dtc/admin/install/interactive_installer
	interactiveInstaller
	DTCinstallPackage
	/usr/share/dtc/admin/install/uninstall
	. ${DTC_SAVED_INSTALL_CONFIG}
	/usr/share/dtc/admin/install/functions
	# Then call the installer!
	DTCsetupDaemons
elif [ -f SuSE-release ] ; then
	# Prepare everything
	. /usr/share/dtc/admin/install/suse_config
	. /usr/share/dtc/admin/install/functions
	. /usr/share/dtc/admin/install/interactive_installer
	interactiveInstaller
	DTCinstallPackage
	/usr/share/dtc/admin/install/uninstall
	. ${DTC_SAVED_INSTALL_CONFIG}
	/usr/share/dtc/admin/install/functions
	# Then call the installer!
	DTCsetupDaemons
fi

UNAME_MINUS_S=`uname -s`
if [ "${UNAME_MINUS_S}" = "Darwin" ] ; then
	. /usr/share/dtc/admin/install/osx_config
	. /usr/share/dtc/admin/install/functions
	. /usr/share/dtc/admin/install/interactive_installer
	interactiveInstaller
	DTCinstallPackage
	/usr/share/dtc/admin/install/uninstall
	DTCsetupDaemons
fi

if [ ${UNAME_MINUS_S} = "FreeBSD" ] ; then
	echo "FreeBSD detected"
	. /usr/local/www/dtc/admin/install/functions
fi

if [ -e /etc/gentoo-release ] ; then
	echo "Gentoo detected"
	. /usr/share/dtc/admin/install/gentoo_config
	. /usr/share/dtc/admin/install/functions
	. /usr/share/dtc/admin/install/interactive_installer
	interactiveInstaller
	DTCinstallPackage
	/usr/share/dtc/admin/install/uninstall
	. ${DTC_SAVED_INSTALL_CONFIG}
	/usr/share/dtc/admin/install/functions
	DTCsetupDaemons
fi
