#!/bin/sh

# Debian config sh script for DTC
# Written by Thomas GOIRAND <thomas@goirand.fr>
# under LGPL Licence

action=$1
version=$2

# Source debconf library -- we have a Depends line
# to make sure it is there...
. /usr/share/debconf/confmodule
db_version 2.0
db_input medium dtc/conf_mysqlhost
db_input medium dtc/conf_mysqllogin
db_input high dtc/conf_mysqlpass
db_input medium dtc/conf_mysqldb
db_input high dtc/conf_mysql_change_root
db_input high dtc/conf_mta_type
db_input high dtc/conf_apache_version
db_input medium dtc/main_domainname
db_input medium dtc/dtc_adminsubdomain
db_input high dtc/conf_ipaddr
db_input medium dtc/conf_use_nated_vhosts
db_input medium dtc/conf_nated_vhosts_ip
db_input medium dtc/conf_hostingpath
db_input low dtc/conf_chroot_path
db_input medium dtc/conf_admlogin
db_input high dtc/conf_admpass
db_input high dtc/conf_gen_ssl_cert
db_input high dtc/conf_cert_passphrase
db_input medium dtc/conf_cert_countrycode
db_input medium dtc/conf_cert_locality
db_input high dtc/conf_cert_organization
db_input low dtc/conf_cert_unit
db_input high dtc/conf_cert_email
db_input high dtc/conf_cert_challenge_pass
db_input high dtc/conf_upgrade_pear
db_input low dtc/conf_dnsbl_list

db_get dtc/conf_eth2monitor
conf_eth2monitor=$RET
echo Value of conf_eth2monitor: ${conf_eth2monitor}
if [ -z "$conf_eth2monitor" ] ; then
	NBRLINES=`grep -v "lo:" /proc/net/dev | wc -l`
	NBRIFACE=$((${NBRLINES} - 2 ))
	CNT=${NBRIFACE}
	ALL_IFACES=''
	while [ ${CNT} -gt 0 ] ; do
		ALL_IFACES=${ALL_IFACES}' '`grep -v "lo:" /proc/net/dev | tail -n ${CNT} | cut -f 1 -d':' | gawk -F ' ' '{print $1}' | head -n 1`
		CNT=$((${CNT} - 1 ))
	done
	db_set dtc/conf_eth2monitor "${ALL_IFACES}"
fi
db_input high dtc/conf_eth2monitor
db_go

exit 0;
#!/bin/sh


